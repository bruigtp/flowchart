<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="flowchart">
<title>flowchart • flowchart</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="flowchart">
<meta property="og:description" content="flowchart">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">flowchart</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/flowchart.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bruigtp/flowchart/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>flowchart</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bruigtp/flowchart/blob/HEAD/vignettes/flowchart.Rmd" class="external-link"><code>vignettes/flowchart.Rmd</code></a></small>
      <div class="d-none name"><code>flowchart.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>flowchart</code> is a package for drawing participant flow
diagrams directly from a dataframe using tidyverse. It provides a set of
functions that can be combined with <code>|&gt;</code> to create all
kinds of flowcharts from a dataframe in an easy way:</p>
<ul>
<li><p><code><a href="../reference/as_fc.html">as_fc()</a></code> transforms a dataframe into a
<code>fc</code> object that can be manipulated by the package.</p></li>
<li><p><code><a href="../reference/fc_split.html">fc_split()</a></code> splits a flowchart according to the
different values of a column in the dataframe.</p></li>
<li><p><code><a href="../reference/fc_filter.html">fc_filter()</a></code> creates a filtered box from the
flowchart, based on the evaluation of an expression in the
dataframe.</p></li>
<li><p><code><a href="../reference/fc_merge.html">fc_merge()</a></code> combines horizontally two different
flowcharts.</p></li>
<li><p><code><a href="../reference/fc_stack.html">fc_stack()</a></code> combines vertically two different
flowcharts.</p></li>
<li><p><code><a href="../reference/fc_modify.html">fc_modify()</a></code> allows to modify the parameters of the
flowchart which are stored in <code>.$fc</code>.</p></li>
<li><p><code><a href="../reference/fc_draw.html">fc_draw()</a></code> draws the flowchart created by the
previous functions.</p></li>
<li><p><code><a href="../reference/fc_export.html">fc_export()</a></code> allows to export the flowchart drawn to
the desired format.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"flowchart"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-dataset">Example dataset<a class="anchor" aria-label="anchor" href="#example-dataset"></a>
</h2>
<p>We will use the built-in datasets in the
package:<code>clinic_patient</code> and <code>clinic_visit</code>. These
datasets belong to the same simulated clinical trial, one containing the
information per patient and the other per visit. This study simulates a
clinical trial in which subjects have been randomised into a control and
treatment group after meeting some inclusion criteria: over 18 years of
age and signed informed consent. These subjects are then followed for
two visits and observations are collected on a biomarker.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">clinic_patient</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">clinic_visit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Per patient dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">clinic_patient</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tibble [230 × 6] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ id        : int [1:230] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ age       : int [1:230] 63 84 80 36 19 52 27 68 86 76 ...</span></span>
<span><span class="co">##  $ consent   : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ group     : Factor w/ 2 levels "Control","Treatment": 2 1 2 2 1 1 2 2 2 1 ...</span></span>
<span><span class="co">##  $ n_visits  : num [1:230] 1 2 2 2 2 2 2 1 2 2 ...</span></span>
<span><span class="co">##  $ marker_alt: Factor w/ 2 levels "Marker not altered (&lt;5)",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Per visit dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">clinic_visit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## tibble [411 × 6] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ id     : int [1:411] 1 2 2 3 3 4 4 5 5 6 ...</span></span>
<span><span class="co">##  $ age    : int [1:411] 63 84 84 80 80 36 36 19 19 52 ...</span></span>
<span><span class="co">##  $ consent: Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ group  : Factor w/ 2 levels "Control","Treatment": 2 1 1 2 2 2 2 1 1 1 ...</span></span>
<span><span class="co">##  $ visit  : num [1:411] 1 1 2 1 2 1 2 1 2 1 ...</span></span>
<span><span class="co">##  $ marker : num [1:411] 0.316 1.989 1.511 0.708 1.903 ...</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="basic-operations">Basic operations<a class="anchor" aria-label="anchor" href="#basic-operations"></a>
</h2>
<p>The first step is to initialise the flowchart with
<code>as_fc</code>. The last step, if we want to visualise the created
flowchart, is to draw the flowchart with <code>fc_draw</code>. In
between we can combine the functions <code>fc_split</code>.,
<code>fc_filter</code>, <code>fc_merge</code>, <code>fc_stack</code>
with the operator pipe (<code>|&gt;</code>) to create complex flowchart
structures.</p>
<div class="section level3">
<h3 id="initialize">Initialize<a class="anchor" aria-label="anchor" href="#initialize"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="va">clinic_patient</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "fc"</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 2</span></span>
<span><span class="co">##  $ data: tibble [230 × 6] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##   ..$ id        : int [1:230] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##   ..$ age       : int [1:230] 63 84 80 36 19 52 27 68 86 76 ...</span></span>
<span><span class="co">##   ..$ consent   : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##   ..$ group     : Factor w/ 2 levels "Control","Treatment": 2 1 2 2 1 1 2 2 2 1 ...</span></span>
<span><span class="co">##   ..$ n_visits  : num [1:230] 1 2 2 2 2 2 2 1 2 2 ...</span></span>
<span><span class="co">##   ..$ marker_alt: Factor w/ 2 levels "Marker not altered (&lt;5)",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ fc  : tibble [1 × 14] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##   ..$ id          : num 1</span></span>
<span><span class="co">##   ..$ x           : num 0.5</span></span>
<span><span class="co">##   ..$ y           : num 0.5</span></span>
<span><span class="co">##   ..$ n           : int 230</span></span>
<span><span class="co">##   ..$ N           : int 230</span></span>
<span><span class="co">##   ..$ perc        : chr "100"</span></span>
<span><span class="co">##   ..$ text        : chr "Initial dataframe\n230"</span></span>
<span><span class="co">##   ..$ type        : chr "init"</span></span>
<span><span class="co">##   ..$ group       : logi NA</span></span>
<span><span class="co">##   ..$ just        : chr "center"</span></span>
<span><span class="co">##   ..$ text_color  : chr "black"</span></span>
<span><span class="co">##   ..$ text_fs     : num 8</span></span>
<span><span class="co">##   ..$ bg_fill     : chr "white"</span></span>
<span><span class="co">##   ..$ border_color: chr "black"</span></span>
<span><span class="co">##  - attr(*, "class")= chr "fc"</span></span></code></pre>
<p>The <code>fc</code> object created is a list containing the tibble of
the dataframe associated with the flowchart and the tibble that stores
the flowchart parameters.</p>
<p>Alternatively, if a dataframe is not available, we can initialize a
flowchart using the <code>N =</code> argument manually specifying the
number of rows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">230</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="draw">Draw<a class="anchor" aria-label="anchor" href="#draw"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="filter">Filter<a class="anchor" aria-label="anchor" href="#filter"></a>
</h3>
<p>We can filter the flowchart using <code><a href="../reference/fc_filter.html">fc_filter()</a></code> specifying
the logic in which the filter is to be applied. For example, we want to
show the number of patients included in the study, that is, those over
the age of 18 who have signed an informed consent.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinic_patient</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Patients included"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_filter.html">fc_filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">18</span> <span class="op">&amp;</span> <span class="va">consent</span> <span class="op">==</span> <span class="st">"Yes"</span>, label <span class="op">=</span> <span class="st">"Patients included"</span>, show_exc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<p>See ‘Modify function arguments’ for more information on the
<code>label=</code> and <code>show_exc=</code> arguments.</p>
<p>Alternatively, if the column to filter is not available, we can use
the <code>N =</code> argument to manually specify the number of rows of
the resulting filter:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinic_patient</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Patients included"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_filter.html">fc_filter</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">200</span>, label <span class="op">=</span> <span class="st">"Patients included"</span>, show_exc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="split">Split<a class="anchor" aria-label="anchor" href="#split"></a>
</h3>
<p>We can split the flowchart into groups using <code><a href="../reference/fc_split.html">fc_split()</a></code>
specifying the grouping variable. The function will split the flowchart
into as many categories as the specified variable has:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinic_patient</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Patients included"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<p>Alternatively, if the column to split is not available, we can use
the <code>N =</code> argument to manually specify the number of rows in
each group of the resulting split:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinic_patient</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Patients included"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treatment"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="combine">Combine<a class="anchor" aria-label="anchor" href="#combine"></a>
</h2>
<p><code><a href="../reference/fc_merge.html">fc_merge()</a></code> and <code><a href="../reference/fc_stack.html">fc_stack()</a></code> allow you to
combine different flowcharts horizontally or vertically. This is very
useful when you need to combine flowcharts generated from different
dataframes, as shown here.</p>
<div class="section level3">
<h3 id="merge">Merge<a class="anchor" aria-label="anchor" href="#merge"></a>
</h3>
<p>We can combine different flowcharts horizontally using
<code><a href="../reference/fc_merge.html">fc_merge()</a></code>. For example, we might want to represent the
flow of patients included in the study next to the flow of their
corresponding visits:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create first flowchart for patients</span></span>
<span><span class="va">fc1</span> <span class="op">&lt;-</span> <span class="va">clinic_patient</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Patients included"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create second flowchart for visits</span></span>
<span><span class="va">fc2</span> <span class="op">&lt;-</span> <span class="va">clinic_visit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Number of visits"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fc1</span>, <span class="va">fc2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_merge.html">fc_merge</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="stack">Stack<a class="anchor" aria-label="anchor" href="#stack"></a>
</h3>
<p>We can combine different flowcharts vertically using
<code><a href="../reference/fc_stack.html">fc_stack()</a></code>. For example, we might want to combine in one
flowchart the flow of patients included in the study and the flow of
their corresponding visits, which come from different dataframes:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create first flowchart for patients</span></span>
<span><span class="va">fc1</span> <span class="op">&lt;-</span> <span class="va">clinic_patient</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Patients included"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create second flowchart for visits</span></span>
<span><span class="va">fc2</span> <span class="op">&lt;-</span> <span class="va">clinic_visit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>hide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span><span class="va">group</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Number of visits (Control)"</span>, <span class="st">"Number of visits (Treatment)"</span><span class="op">)</span>, text_pattern <span class="op">=</span> <span class="st">"{label}\n {n}"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fc1</span>, <span class="va">fc2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_stack.html">fc_stack</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
<p>See ‘Modify function arguments’ for more information on the
<code>hide=</code> and <code>text_pattern=</code> arguments.</p>
</div>
</div>
<div class="section level2">
<h2 id="customize-output">Customize output<a class="anchor" aria-label="anchor" href="#customize-output"></a>
</h2>
<p>We can customize the flowchart either with the arguments provided by
each function in the process of creating it, or directly in the final
output using the function <code>modify_fc</code>.</p>
<div class="section level3">
<h3 id="modify-function-arguments">Modify function arguments<a class="anchor" aria-label="anchor" href="#modify-function-arguments"></a>
</h3>
<p>Arguments common to <code><a href="../reference/as_fc.html">as_fc()</a></code>, <code><a href="../reference/fc_filter.html">fc_filter()</a></code>
and <code><a href="../reference/fc_split.html">fc_split()</a></code>, to customise the appearance of the boxes
created at each step:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Argument
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>label=</code>
</td>
<td style="text-align:left;">
modify the label.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>text_pattern=</code>
</td>
<td style="text-align:left;">
modify the pattern of the text.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>text_color=</code>
</td>
<td style="text-align:left;">
modify the color of the text.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>text_fs=</code>
</td>
<td style="text-align:left;">
modify the font size of the text.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>bg_fill=</code>
</td>
<td style="text-align:left;">
modify the background color of the box.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>border_color=</code>
</td>
<td style="text-align:left;">
modify the border color of the box.
</td>
</tr>
</tbody>
</table>
<p><code><a href="../reference/as_fc.html">as_fc()</a></code> arguments:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Argument
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
<code>hide=</code>
</td>
<td style="text-align:left;">
hide the first initial box created by this function.
</td>
</tr></tbody>
</table>
<p><code><a href="../reference/fc_filter.html">fc_filter()</a></code> arguments:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Argument
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>sel_group=</code>
</td>
<td style="text-align:left;">
apply the filter only in the specified groups (if data is grouped).
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>round_digits=</code>
</td>
<td style="text-align:left;">
modify the number of digits to round percentages.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>show_exc=</code>
</td>
<td style="text-align:left;">
show the box with the excluded rows that do not match the filter.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>direction_exc=</code>
</td>
<td style="text-align:left;">
change the direction of the exclusion box (left or right).
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>label_exc=</code>
</td>
<td style="text-align:left;">
modify the label of the exclusion box.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>text_pattern_exc=</code>
</td>
<td style="text-align:left;">
modify the pattern of the exclusion box.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>text_color_exc=</code>
</td>
<td style="text-align:left;">
modify the color of the text in the exclusion box.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>text_fs_exc=</code>
</td>
<td style="text-align:left;">
modify the font size of the text in the exclusion box.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>bg_fill_exc=</code>
</td>
<td style="text-align:left;">
modify the background color of the exclusion box.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>border_color_exc=</code>
</td>
<td style="text-align:left;">
modify the border color of the exclusion box.
</td>
</tr>
</tbody>
</table>
<p><code><a href="../reference/fc_split.html">fc_split()</a></code> arguments:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Argument
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>sel_group=</code>
</td>
<td style="text-align:left;">
split the flowchart only in the specified groups (if data is grouped).
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>na.rm=</code>
</td>
<td style="text-align:left;">
omit the missing values in the grouping variable.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>round_digits=</code>
</td>
<td style="text-align:left;">
modify the number of digits to round percentages.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>show_zero=</code>
</td>
<td style="text-align:left;">
omit the levels of the grouping variable that don’t have an event.
</td>
</tr>
</tbody>
</table>
<p><code><a href="../reference/fc_draw.html">fc_draw()</a></code> arguments are heredited from
<code>arrow</code>:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Argument
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>arrow_angle=</code>
</td>
<td style="text-align:left;">
angle of the arrow head in degrees.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>arrow_length=</code>
</td>
<td style="text-align:left;">
unit specifying the length of the arrow head.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>arrow_ends=</code>
</td>
<td style="text-align:left;">
specify the ends of the line to draw the arrow head (last/first/both).
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>arrow_type=</code>
</td>
<td style="text-align:left;">
whether the arrow head should be a closed triangle.
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="function-to-customize-the-flowchart">Function to customize the flowchart<a class="anchor" aria-label="anchor" href="#function-to-customize-the-flowchart"></a>
</h3>
<p>The function <code>modify_fc</code> allows the user to customise the
created flowchart by modifying its parameters, which are stored in
<code>.$fc</code>.</p>
<p>For example, we could fully customise the text in the exclusion box
if we wanted to specify the different reasons for exclusion:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="va">clinic_patient</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Patients included"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_filter.html">fc_filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">18</span> <span class="op">&amp;</span> <span class="va">consent</span> <span class="op">==</span> <span class="st">"Yes"</span>, label <span class="op">=</span> <span class="st">"Patients included"</span>, show_exc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_modify.html">fc_modify</a></span><span class="op">(</span><span class="op">~</span><span class="va">.x</span> <span class="op">|&gt;</span> </span>
<span>              <span class="fu">mutate</span><span class="op">(</span></span>
<span>                text <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>                  <span class="va">id</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="fu">str_glue</span><span class="op">(</span><span class="st">"Excluded patients:</span></span>
<span><span class="st">                                     - {sum(clinic_patient$age &lt; 18)} under-age</span></span>
<span><span class="st">                                     - {sum(clinic_patient$consent == 'No')} without a signed consent</span></span>
<span><span class="st">                                     "</span><span class="op">)</span>,</span>
<span>                  <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">text</span></span>
<span>                <span class="op">)</span></span>
<span>              <span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">fc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
<p>We could also use <code><a href="../reference/fc_modify.html">fc_modify()</a></code> to change the default
<em>x</em> and <em>y</em> coordinates:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_modify.html">fc_modify</a></span><span class="op">(</span><span class="op">~</span><span class="va">.x</span> <span class="op">|&gt;</span> </span>
<span>              <span class="fu">mutate</span><span class="op">(</span></span>
<span>                x <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>                  <span class="va">id</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="fl">0.8</span>,</span>
<span>                  <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">x</span></span>
<span>                <span class="op">)</span>,</span>
<span>                y <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>                  <span class="va">id</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">0.85</span>,</span>
<span>                  <span class="va">id</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="fl">0.15</span>,</span>
<span>                  <span class="va">id</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="fl">0.5</span></span>
<span>                <span class="op">)</span></span>
<span>              <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="export">Export<a class="anchor" aria-label="anchor" href="#export"></a>
</h2>
<p>Once the flowchart has been drawn we can export it to the most
popular image formats (png, jpeg, tiff) using
<code><a href="../reference/fc_export.html">fc_export()</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinic_patient</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Patients included"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_export.html">fc_export</a></span><span class="op">(</span><span class="st">"flowchart.png"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clinic_patient</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Available patients"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_filter.html">fc_filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">18</span> <span class="op">&amp;</span> <span class="va">consent</span> <span class="op">==</span> <span class="st">"Yes"</span>, label <span class="op">=</span> <span class="st">"Patients included"</span>, show_exc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_filter.html">fc_filter</a></span><span class="op">(</span><span class="va">n_visits</span> <span class="op">==</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="st">"Two visits available"</span>, show_exc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span><span class="va">marker_alt</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Marker not altered"</span>, <span class="st">"Marker altered"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="example-2">Example 2<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h3>
<p>For this example, we will use another built-in dataset called
<code>safo</code>, which is a randomly generated dataset from the SAFO
trial. SAFO is an open-label, multicentre, phase III–IV superiority
randomised clinical trial designed to assess whether cloxacillin plus
fosfomycin administered during the first 7 days of therapy achieves
better treatment outcomes than cloxacillin alone in hospitalised
patients with meticillin-sensitive Staphylococcus aureus bacteraemia. In
this example, we reproduce the original flowchart of the trial published
in Nature Medicine<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Grillo, S., Pujol, M., Miró, J.M. et al. Cloxacillin
plus fosfomycin versus cloxacillin alone for methicillin-susceptible
Staphylococcus aureus bacteremia: a randomized trial. Nat Med 29,
2518–2525 (2023). &lt;a href="https://doi.org/10.1038/s41591-023-02569-0" class="external-link uri"&gt;https://doi.org/10.1038/s41591-023-02569-0&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>.</p>
<p>First, we need to do some pre-processing to reproduce the text in the
larger boxes:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create labels for exclusion box:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">safo</span><span class="op">)</span></span>
<span></span>
<span><span class="va">label_exc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">str_glue</span><span class="op">(</span><span class="st">"{sum(safo$inclusion_crit == 1 | safo$exclusion_crit == 1 | safo$decline_part == 1, na.rm = T)} excluded:"</span><span class="op">)</span>,</span>
<span>    <span class="fu">map_chr</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inclusion_crit"</span>, <span class="st">"decline_part"</span>, <span class="st">"exclusion_crit"</span><span class="op">)</span>, <span class="op">~</span><span class="fu">str_glue</span><span class="op">(</span><span class="st">"{sum(safo[[.x]] == 1, na.rm = TRUE)} {attr(safo[[.x]], 'label')}"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu">map_chr</span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">15</span>, <span class="op">~</span><span class="fu">str_glue</span><span class="op">(</span><span class="st">" -  {sum(safo[[.x]] == 1)} {attr(safo[[.x]], 'label')}"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">label_exc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"exclusion criteria"</span>, <span class="st">"exclusion criteria:"</span>, <span class="va">label_exc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">safo1</span> <span class="op">&lt;-</span> <span class="va">safo</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"cloxacillin alone"</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">reason_pp</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>reason_pp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">reason_pp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">label_exc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">str_glue</span><span class="op">(</span><span class="st">"{nrow(safo1)} excluded:"</span><span class="op">)</span>,</span>
<span>    <span class="fu">map_chr</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">safo1</span><span class="op">$</span><span class="va">reason_pp</span><span class="op">)</span>, <span class="op">~</span><span class="fu">str_glue</span><span class="op">(</span><span class="st">" -  {sum(safo1$reason_pp == .x)} {.x}"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">label_exc1</span> <span class="op">&lt;-</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">label_exc1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"resistant"</span> <span class="op">=</span> <span class="st">"resistant\n"</span>, <span class="st">"blood"</span> <span class="op">=</span> <span class="st">"blood\n"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">safo2</span> <span class="op">&lt;-</span> <span class="va">safo</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"cloxacillin plus fosfomycin"</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">reason_pp</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>reason_pp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">reason_pp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">label_exc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">str_glue</span><span class="op">(</span><span class="st">"{nrow(safo2)} excluded:"</span><span class="op">)</span>,</span>
<span>    <span class="fu">map_chr</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">safo2</span><span class="op">$</span><span class="va">reason_pp</span><span class="op">)</span>, <span class="op">~</span><span class="fu">str_glue</span><span class="op">(</span><span class="st">" -  {sum(safo2$reason_pp == .x)} {.x}"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">label_exc2</span> <span class="op">&lt;-</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">label_exc2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nosocomial"</span> <span class="op">=</span> <span class="st">"nosocomial\n"</span>, <span class="st">"treatment"</span> <span class="op">=</span> <span class="st">"treatment\n"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Second, let’s create and customise the flowchart using the functions
in the package:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">safo</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"patients assessed for eligibility"</span>, text_pattern <span class="op">=</span> <span class="st">"{n} {label}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_filter.html">fc_filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"randomized"</span>, text_pattern <span class="op">=</span> <span class="st">"{n} {label}"</span>, show_exc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            just_exc <span class="op">=</span> <span class="st">"left"</span>, text_pattern_exc <span class="op">=</span> <span class="st">"{label}"</span>, label_exc <span class="op">=</span> <span class="va">label_exc</span>, text_fs_exc <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span><span class="va">group</span>, text_pattern <span class="op">=</span> <span class="st">"{n} {label}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_filter.html">fc_filter</a></span><span class="op">(</span><span class="va">itt</span> <span class="op">==</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="st">"included in intention-to-treat\n population"</span>, show_exc <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            text_pattern <span class="op">=</span> <span class="st">"{n} {label}"</span>, </span>
<span>            label_exc <span class="op">=</span> <span class="st">"patient did not receive allocated\n treatment (withdrew consent)"</span>, </span>
<span>            text_pattern_exc <span class="op">=</span> <span class="st">"{n} {label}"</span>, text_fs_exc <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/fc_filter.html">fc_filter</a></span><span class="op">(</span><span class="va">pp</span> <span class="op">==</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="st">"included in per-protocol\n population"</span>, show_exc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            just_exc <span class="op">=</span> <span class="st">"left"</span>, text_pattern <span class="op">=</span> <span class="st">"{n} {label}"</span>, text_fs_exc <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_modify.html">fc_modify</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">.x</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">!=</span> <span class="fl">9</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">mutate</span><span class="op">(</span></span>
<span>        text <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">11</span> <span class="op">~</span> <span class="va">label_exc1</span>, <span class="va">id</span> <span class="op">==</span> <span class="fl">13</span> <span class="op">~</span> <span class="va">label_exc2</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">text</span><span class="op">)</span>,</span>
<span>        x <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">0.15</span>, <span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">13</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">0.01</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="va">y</span> <span class="op">+</span> <span class="fl">0.05</span>, <span class="va">id</span> <span class="op">&gt;=</span> <span class="fl">2</span> <span class="op">~</span> <span class="va">y</span> <span class="op">-</span> <span class="fl">0.05</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">y</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-18-1.png" width="1056"></p>
</div>
<div class="section level3">
<h3 id="example-3">Example 3<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h3>
<p>In this example, we will create a flowchart without any dataframe,
using the <code>N =</code> argument to manually specify the numbers to
display in the boxes:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as_fc.html">as_fc</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_filter.html">fc_filter</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">240</span>, label <span class="op">=</span> <span class="st">"Randomized patients"</span>, show_exc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_split.html">fc_split</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">80</span>, <span class="fl">60</span><span class="op">)</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group A"</span>, <span class="st">"Group B"</span>, <span class="st">"Group C"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/fc_filter.html">fc_filter</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">75</span>, <span class="fl">50</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"Finished the study"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fc_draw.html">fc_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowchart_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pau Satorra, João Carmezim, Natàlia Pallarès, Cristian Tebé.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
